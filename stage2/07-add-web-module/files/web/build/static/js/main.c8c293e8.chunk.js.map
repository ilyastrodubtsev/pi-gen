{"version":3,"sources":["serviceWorker.js","Button.js","MicButton.js","FullscreenButton.js","ZoomButton.js","SettingsButton.js","Joystick.js","Video.js","Dialog.js","Status.js","Spinner.js","App.js","index.js"],"names":["Boolean","window","location","hostname","match","requestAnimationFrame","_callee2","regenerator_default","a","wrap","_context2","prev","next","abrupt","Promise","resolve","stop","MOBILE","Button","state","animationName","onClick","e","console","log","_this","onTouchStart","_callee","_context","props","setStateAsync","onTouchEnd","embed","preventDefault","_this2","this","setState","canTouch","_ref2","react_default","createElement","className","id","style","Object","objectSpread","concat","disabled","buttonStyle","index_es","icon","faCoffee","Component","MicButton","faMicrophoneAlt","muted","buttonClick","faMicrophoneAltSlash","onMute","Button_Button","top","left","isFullscreen","document","webkitFullscreenElement","mozFullScreenElement","FullscreenButton","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","faExpand","onFullscreen","fs","faCompress","documentElement","mozRequestFullScreen","webkitRequestFullScreen","webkitCancelFullScreen","mozCancelFullScreen","fullscreen","addEventListener","ZoomButton","width","height","fontSize","PlusButton","ZoomButton_ZoomButton","faPlus","MinusButton","faMinus","SettingsDropdown","dd","React","createRef","show","fit_mode","quality","settingsChanged","_e$target","target","name","value","onChange","defineProperty","Dropdown","drop","position","Toggle","as","faCog","Menu","Form","Group","Label","Control","smoothK","CAMERA_STEP_INTERVAL","Joystick","joystick","nipple","nipplejs","create","zone","current","mode","color","on","evt","data","onEnd","type","onMove","angle","degree","force","onAngle","direction","ref","pos","EngineJoystick","_Component2","_getPrototypeOf3","_this3","_len2","arguments","length","args","Array","_key2","apply","smoothA","smoothAngle","inherits","createClass","key","k","Math","expm1","Joystick_Joystick","CameraJoystick","_Component3","_getPrototypeOf4","_this4","_len3","_key3","tm","f","plains","right","down","up","_plains$_this4$angle","slicedToArray","setInterval","clearInterval","RESIZE_TIMEOUT","DW","DH","MAXW","MAXH","MINW","MINH","KEYS","KeyA","KeyD","KeyS","KeyW","QUALITY","quality_low","quality_med","quality_hi","Video","fit_width","fit_height","fitMode","resizeTm","scale","tX","tY","X","Y","video","touchDown","stopPropagation","ev","nativeEvent","x","touches","pageX","y","pageY","touchMove","el","buttons","dx","dy","debug","rect","getBoundingClientRect","W","clientWidth","H","clientHeight","maxX","maxY","setTransform","playing","onStarted","resize","paused","time","onTime","currentTime","w","h","round","dh","abs","dw","W1","H1","fit","W2","H2","newW","newH","zoom","clearTimeout","setTimeout","onResize","onKeyDown","code","onCameraMove","connectWebRTC","then","config","janus","deps","Janus","useDefaultDependencies","adapter","init","dependencies","callback","showErrorAndReload","onError","isWebrtcSupported","me","reject","server","success","error","destroyed","reload","haveAudio","opaqueId","randomString","attach","plugin","onmessage","msg","jsep","result","status","played","streaming","createAnswer","media","audioSend","videoSend","send","message","request","onremotestream","stream","vid","attachMediaStream","oncleanup","navigator","mediaDevices","enumerateDevices","devices","_iterator","Symbol","iterator","_iteratorNormalCompletion","_step","done","kind","list","tr","transform","z","b","muteAudio","unmuteAudio","parseInt","getBitrate","v","videoWidth","videoHeight","webRTCAdapter","browserDetails","browser","autoPlay","playsInline","loop","onMouseDown","onMouseMove","onTouchMove","onPlaying","onTimeUpdate","RetryReload","_Component","_getPrototypeOf2","_len","_key","header","text","handleClose","onClose","_show","asyncToGenerator","mark","_x","Modal","onHide","dialogClassName","Header","closeButton","faExclamationTriangle","Title","Body","Footer","es_Button","variant","Status","info","extra","Spinner","hidden","CAMERA_MOVE_STEP","App","joystickConnected","plusDisabled","minusDisabled","statusText","loading","reconnectTimeout","ws","modal","plus","minus","spinner","onJoystickMove","sendCommand","cmd","onJoystickEnd","t","onSettingsChanged","set","onVideoError","_ref","res","sent","onVideoStarted","updateScaleButtons","statusInterval","onVideoTime","statusExtra","toFixed","onVideoSize","onZoomIn","onZoomOut","d","_plains$d","plain","step","onCameraJoystickEnd","onCameraJoystickMove","mute","fetchConfig","connectJoystick","WebSocket","onopen","JSON","stringify","onerror","err","onclose","fetch","response","json","cfg","replace","host","_React$createElement","Fragment","Spinner_Spinner","Video_Video","MicButton_MicButton","FullscreenButton_FullscreenButton","Joystick_EngineJoystick","Joystick_CameraJoystick","SettingsButton_SettingsDropdown","ZoomButton_PlusButton","ZoomButton_MinusButton","Dialog_RetryReload","Status_Status","ReactDOM","render","App_App","getElementById","body","passive","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.c8c293e8.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import './Button.css';\n\nimport React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCoffee } from '@fortawesome/free-solid-svg-icons'\n\n\nasync function requestAnimationFrame() {\n  return new Promise((resolve) => {\n    window.requestAnimationFrame(resolve);\n  })\n}\n\nconst MOBILE = ('ontouchstart' in window );\n\nexport default class Button extends Component {\n  state = {animationName: ''};\n\n  setStateAsync(state) {\n    return new Promise((resolve) => {\n      this.setState(state, resolve)\n    });\n  }\n\n  onClick = (e) => {\n    console.log('onClick');\n    this.onTouchStart(e);\n  }\n\n  onTouchStart = async (e) => {\n    console.log('onTouchStart');\n    this.props.onClick(e);\n    \n    await this.setStateAsync({animationName: ''});\n    await requestAnimationFrame();\n    await requestAnimationFrame();\n    await this.setStateAsync({animationName: 'animated'});\n  }\n\n  onTouchEnd = (e) => {\n    console.log('onTouchEnd');\n    if(this.props.embed)\n      e.preventDefault();\n  }\n\n  render() {\n    let onTouchStart, onTouchEnd, onClick;\n    \n    if(!this.props.canTouch) {\n      [onTouchStart, onTouchEnd] = [this.onTouchStart, this.onTouchEnd];\n    }\n    if(this.props.canTouch || !MOBILE)\n      onClick = this.onClick;\n\n    return (\n      <div className={this.props.embed? \"\": \"inline-div\"}\n          id={this.props.id}\n          style={ {...this.props.style} } >\n        <div className=\"flex-div\">\n            <button \n              className={`flex-a flex-animated ${this.props.disabled? \"toolButton-disabled\": \"\" }`}\n              onTouchStart={onTouchStart}\n              onTouchEnd={onTouchEnd}\n              onClick={onClick}\n              style={ {animationName: this.state.animationName, ...this.props.buttonStyle} }>\n                <FontAwesomeIcon icon={this.props.icon || faCoffee} />\n            </button>\n        </div>\n      </div>\n    );\n  }\n}\n\n","import React, { Component } from 'react';\nimport Button from './Button'\nimport { faMicrophoneAlt, faMicrophoneAltSlash } from '@fortawesome/free-solid-svg-icons';\n\n\nexport default class MicButton extends Component {\n  state = {icon: faMicrophoneAlt, muted: false};\n\n  buttonClick = (e) => {\n    console.log('[Mic] button clicked');      \n    this.setState({\n        icon: this.state.muted? faMicrophoneAlt: faMicrophoneAltSlash, \n        muted: !this.state.muted\n      }, () => {\n        this.props.onMute(this.state.muted);\n      });\n  }\n\n  render() {\n    return ( <Button id=\"mic-button-div\"\n                style={{\n                  top: 'calc(90% - 3rem)',\n                  left: 'calc(95% - 3rem)'\n                }}\n                icon={this.state.icon}\n                onClick={this.buttonClick}> \n              </Button> );\n  }\n}\n\n","import React, { Component } from 'react';\nimport Button from './Button'\nimport { faCompress, faExpand } from '@fortawesome/free-solid-svg-icons'\n\nfunction fullscreen(fs) {\n  if(fs) {\n    let e = document.documentElement;\n    (e.mozRequestFullScreen && e.mozRequestFullScreen()) ||\n    (e.webkitRequestFullScreen && e.webkitRequestFullScreen());\n  } else {\n      (document.webkitCancelFullScreen && document.webkitCancelFullScreen()) ||\n      (document.mozCancelFullScreen && document.mozCancelFullScreen());\n  }\n}\nfunction isFullscreen() {\n  return !!(document.webkitFullscreenElement || document.mozFullScreenElement);\n}\n\nexport default class FullscreenButton extends Component {\n  state = {icon: faExpand};\n\n  constructor() {\n    super();\n    document.addEventListener(\"webkitfullscreenchange\", this.onFullscreen);\n    document.addEventListener(\"mozfullscreenchange\", this.onFullscreen);\n  }\n\n  onFullscreen = () => {\n    console.log('fullscreen');\n    let fs = isFullscreen();\n    this.setState({icon: fs? faCompress: faExpand});\n  }\n\n  buttonClick = (e) => {\n    console.log('[Fullscreen] button clicked');\n    fullscreen(!isFullscreen());\n  }\n\n  render() {\n    return ( <Button canTouch\n                style={{\n                  top: '10%',\n                  left: '5%'\n                }}\n                icon={this.state.icon}\n                onClick={this.buttonClick} \n                id=\"fullscreen-button-div\" > \n              </Button> );\n  }\n}\n","import React, { Component } from 'react';\nimport Button from './Button'\nimport { faPlus, faMinus } from '@fortawesome/free-solid-svg-icons';\n\n\nclass ZoomButton extends Component {\n    onClick = (e) => {\n      if(this.props.disabled)\n        return;\n      this.props.onClick(e);\n    }\n\n    render() {\n      return ( <Button disabled={this.props.disabled}\n                  style={this.props.style}\n                  buttonStyle={{\n                    width: '2rem',\n                    height: '2rem',\n                    fontSize: '1rem'\n                  }}\n                  icon={this.props.icon}\n                  onClick={this.onClick} \n                  id={this.props.id}> \n                </Button> );\n    }\n  }\n\nclass PlusButton extends ZoomButton {\n    render() {\n        return ( <ZoomButton disabled={this.props.disabled}\n                    style={{\n                      top: 'calc(10% - .5rem)',\n                      left: 'calc(95% - 3rem)'\n                    }}\n                    icon={faPlus}\n                    onClick={this.props.onClick} \n                    id=\"plus-button-div\"> \n                  </ZoomButton> );\n      }\n}\n\nclass MinusButton extends Component {\n    render() {\n        return ( <ZoomButton disabled={this.props.disabled}\n                    style={{\n                      top: 'calc(10% + 2rem)',\n                      left: 'calc(95% - 3rem)'\n                    }}\n                    icon={faMinus}\n                    onClick={this.props.onClick} \n                    id=\"minus-button-div\"> \n                  </ZoomButton> );\n      }\n}\n\nexport { PlusButton, MinusButton };\n","import './Settings.css'\nimport React, { Component } from 'react';\nimport {Dropdown, Form} from 'react-bootstrap';\nimport Button from './Button'\nimport { faCog } from '@fortawesome/free-solid-svg-icons'\n\n\nexport default class SettingsDropdown extends Component {\n    /** @type {React.RefObject<HTMLDivElement>} */ dd = React.createRef();\n  state = {show: false, fit_mode: 'fill', quality: 'quality_hi'}\n\n  \n  settingsChanged = (e) => {\n    const {name, value} = e.target;\n    console.log('[Settings] changed', name, value, this.state);\n    this.props.onChange(name, value);\n    this.setState({[name]: value});\n  }\n\n  render() {\n    return ( \n      <Dropdown drop=\"up\" style={{\n          position: 'fixed',\n          top: 'calc(90% - 3rem)',\n          left: '5%'\n      }}>\n          <Dropdown.Toggle as={Button} icon={faCog} embed></Dropdown.Toggle>\n  \n          <Dropdown.Menu>\n            <Form className=\"px-1 py-4\">\n              {/* <Form.Row> */}\n                <Form.Group>\n                    <Form.Label>Fit mode</Form.Label>\n                    <Form.Control as=\"select\" \n                      name=\"fit_mode\"\n                      onChange={this.settingsChanged}\n                      value={this.state.fit_mode}>\n                        <option value=\"fill\">Fill</option>\n                        <option value=\"fit_both\">Fit</option>\n                        <option value=\"fit_width\">Fit Width</option>\n                        <option value=\"fit_height\">Fit Height</option>\n                      </Form.Control>\n                </Form.Group>\n              {/* </Form.Row> */}\n              {/* <Form.Row> */}\n                <Form.Group>\n                    <Form.Label>Quality</Form.Label>\n                    <Form.Control as=\"select\"\n                      name=\"quality\"\n                      value={this.state.quality}\n                      onChange={this.settingsChanged}>\n                        <option value=\"quality_low\">Low</option>\n                        <option value=\"quality_med\">Medium</option>\n                        <option value=\"quality_hi\">High</option>\n                    </Form.Control>\n                </Form.Group>\n              {/* </Form.Row> */}\n            </Form>\n          </Dropdown.Menu>\n        </Dropdown>);\n  }\n}\n","import './Joystick.css'\nimport React, { Component } from 'react';\nimport nipplejs from 'nipplejs';\n\n\nconst smoothK = 4.0, CAMERA_STEP_INTERVAL = 100;\n\nclass Joystick extends Component {\n    joystick = React.createRef();\n    nipple = null;\n\n    componentDidMount() {\n        let nipple = nipplejs.create({\n            zone: this.joystick.current,\n            mode: 'static',\n            position: {left: '50%', top: '50%'},\n            color: 'black'\n        });\n        this.nipple = nipple;\n\n        nipple.on('end', (evt, data) => {\n            if(!this.props.onEnd)\n                return;\n\n            console.log(evt.type, data);\n            if(evt.type == 'end')\n                this.props.onEnd(evt.type)\n            \n        }).on('move', (evt, data) => {\n            if(!this.props.onMove)\n                return;\n            // console.log(data.angle.degree, data.force);\n            let a = 90 - data.angle.degree;\n            if(a < 0)\n                a += 360;\n            if(a < 0)\n                a += 360;\n\n            this.props.onMove(a, data.force)\n        }).on('dir', (evt, data) => {\n            if(!this.props.onAngle)\n                return;\n            console.log(data.direction.angle, data.force);\n            this.props.onAngle(data.direction.angle);\n        });\n    }\n    \n    render() {\n        return (\n            <div className='joystick' ref={this.joystick} style={this.props.pos} />\n        )\n    }\n}\n\nexport class EngineJoystick extends Component {\n\n    smoothAngle(a, k) {\n        return Math.expm1(a/(10.*k))/Math.expm1(9/k)\n    }\n\n    onMove = (a, force) => {\n        let smoothA = 0;\n        if(a < 90.0) {\n            smoothA = 90.0*this.smoothAngle(a, smoothK);\n            // console.log(`${a} -> ${smoothA} (0-90)`);\n        } else if(a >= 90.0 && a < 180.0) {\n            smoothA = 90+90.0*(1.0-this.smoothAngle(180-a, smoothK));\n            // console.log(`${a} -> ${smoothA} (90-180)`);\n        } else if(a >= 180.0 && a < 270.0) {\n            smoothA = 180+90.0*this.smoothAngle(a-180, smoothK);\n            // console.log(`${a} -> ${smoothA} (180-270)`);\n        } else if(a >= 270.0 && a < 360.0) {\n            smoothA = 270+90.0*(1.0-this.smoothAngle(360-a, smoothK));\n            // console.log(`${a} -> ${smoothA} (270-360)`);\n        }\n\n        this.props.onMove(smoothA, force)\n    }\n    onEnd = () => {\n        this.props.onEnd();\n    }\n    render() {\n        return (\n            <Joystick onMove={this.onMove} \n                      onEnd={this.onEnd} \n                      pos={{ \n                        left: '30px',\n                        top: 'calc(50% - 100px/2)'\n                    }}/>\n        );\n    }\n}\nexport class CameraJoystick extends Component {\n    angle = null;\n    force = null;\n    tm = null;\n\n    onMove = (a, f) => {\n        if(!this.angle)\n            return;\n        let plains = {\n            left: ['h', f],\n            right: ['h', -f],\n            down: ['v', f],\n            up: ['v', -f]\n        }\n        let [angle, force] = plains[this.angle];\n        this.props.onMove(angle, force);\n        this.force = f;\n        \n        if(!this.tm) {\n            this.tm = setInterval(() => {\n                this.onMove(this.angle, this.force);\n            }, CAMERA_STEP_INTERVAL);\n        }\n    }\n\n    onAngle = (a) => {\n        this.angle = a;\n    }\n\n    onEnd = () => {\n        if(this.tm) {\n            clearInterval(this.tm);\n            this.tm = null;\n        }\n        this.props.onEnd();\n    }\n\n    render() {\n        return (\n            <Joystick onEnd={this.onEnd} \n                      onMove={this.onMove}\n                      onAngle={this.onAngle}\n                      pos={{ \n                        right: '30px',\n                        top: 'calc(50% - 100px/2)'\n                    }} />\n        )\n    }\n}\n","import './Video.css'\nimport React, { Component } from 'react';\nimport adapter from 'webrtc-adapter';\nimport Janus from 'janus-gateway'\n\n\nconst STREAM_ID = 1;\nconst RESIZE_TIMEOUT = 1000;\nconst DW = 4, DH = 3, MAXW = 1640, MAXH = 1230, MINW = 48, MINH = 36;\nconst KEYS = {\n    KeyA: 'left',\n    KeyD: 'right',\n    KeyS: 'down',\n    KeyW: 'up'\n};\nconst QUALITY={quality_low: 0.3, quality_med: 0.5, quality_hi: 1};\nconst MOBILE = ('ontouchstart' in window );\n\nexport default class Video extends Component {\n    state = {fit_width: false, fit_height: true};\n\n    fitMode = 'fill';\n    quality = 1.0;\n    resizeTm = 0;\n    scale = 1.0;\n    tX=0; tY=0; X=0; Y=0;\n\n    /** @type {React.RefObject<HTMLVideoElement>} */video = React.createRef();\n\n    /** @param {React.SyntheticEvent} e */\n    touchDown = (e) => {\n        if(MOBILE) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        let ev = e.nativeEvent;\n\n        let x = ev.touches? ev.touches[0].pageX: ev.pageX,\n            y = ev.touches? ev.touches[0].pageY: ev.pageY;\n        this.X = x - this.tX;\n        this.Y = y - this.tY;\n\n    }\n\n    /** @param {React.SyntheticEvent} e */\n    touchMove = (e) => {\n        if(MOBILE) {\n            e.preventDefault();            \n            e.stopPropagation();\n        }\n\n        let ev = e.nativeEvent, el = e.target;\n        if(!((ev.type == 'mousemove' && ev.buttons == 1) || ev.type == 'touchmove'))\n            return;\n\n        e.preventDefault();\n        let x = ev.touches? ev.touches[0].pageX: ev.pageX,\n            y = ev.touches? ev.touches[0].pageY: ev.pageY,\n            dx = x - this.X, dy = y - this.Y;\n        console.debug(el, dx);\t\n\n        let rect = this.video.current.getBoundingClientRect(),\n            W = document.documentElement.clientWidth,\n            H = document.documentElement.clientHeight;\n\n        let maxX = (rect.width-W)/2;\n        let maxY = (rect.height-H)/2;\n        if(maxX >= 0) {\n            if(dx > 0 && dx > maxX)\n                dx = maxX;\t\t\n            else if(dx < 0 && dx < -maxX)\n                dx = -maxX;\n        }\n        if(maxY >= 0) {\n            if(dy > 0 && dy > maxY)\n                dy = maxY;\n            else if(dy < 0 && dy < -maxY)\n                dy = -maxY;\n        }\n        if(maxX >= 0 && maxY >= 0)\n            this.setTransform(dx, dy);\n\n    }\n\n    playing = (e) => {\n        console.log(e);\n        this.props.onStarted();\n        this.resize();\n    }\n\n    paused = (e) => {\n        console.log(e);\n    }\n\n    time = (e) => {\n        // TODO: detect pauses\n        // console.log(e.target.currentTime);\n        this.props.onTime(e.target.currentTime);\n    }\n\n    componentDidMount() {\n        this.connectWebRTC().then(() => {\n            this.resize();\n        });\n        window.addEventListener('resize', (e) => {\n            this.resize();\n            console.log(e);\n        });\n\n        window.addEventListener('keydown', (e) => {\n            this.onKeyDown(e);\n        })\n    }\n\n    async connectWebRTC() {\n        if(!this.props.config.janus)\n            return;\n\n        let deps = Janus.useDefaultDependencies({adapter});\n        await new Promise(resolve => Janus.init({\n            debug: 'all',\n            dependencies: deps,\n            callback: resolve}));\n        console.log('Janus inited');\n\n        let showErrorAndReload = async (e) => {\n            console.log(e);\n            await this.props.onError(e);\n            this.connectWebRTC();\n        }\n        \n        if(!Janus.isWebrtcSupported()) {\n            showErrorAndReload(\"No WebRTC support... \");\n        }\n\n        let janus, me=this;\n        await new Promise((resolve, reject) => { janus = new Janus({\n                server: me.props.config.janus,\n                success: resolve,\n                error: showErrorAndReload,\n                destroyed: window.location.reload\n            });\n        });\n        console.log('Janus connected');\n\n        var haveAudio = false;\n\n        let opaqueId = \"streamingtest-\"+Janus.randomString(12);\n        let streaming = await new Promise((resolve, reject) => {\n            janus.attach({\n                plugin: \"janus.plugin.streaming\",\n                opaqueId: opaqueId,\n                success: resolve,\n                error: showErrorAndReload,\n                onmessage: function(msg, jsep) {\n                    Janus.debug(\" ::: Got a message :::\");\n                    Janus.debug(msg);\n                    let result = msg.result;\n                    if(result && result.status) {\n                        if(result.status == 'started') {\n                            console.log('Streaming started!');\n                            if(me.video.current.played.length) {\n                                me.playing();\n                            }\t\t\t\t\t\t\t\n                        }\n                    } else if(msg.error) {\n                        showErrorAndReload(msg.error);\n                    }\n                    if(jsep) {\n                        Janus.debug(\"Handling SDP as well...\");\n                        Janus.debug(jsep);\n        \n                        streaming.createAnswer({\n                            jsep: jsep,\n                            media: { audioSend: haveAudio, videoSend: false },\n                            success: function(jsep) {\n                                Janus.debug(\"Got SDP!\");\n                                Janus.debug(jsep);\n                                streaming.send({\n                                    message: { request: 'start' }, \n                                    jsep: jsep\n                                });\n        // \t\t\t\t\t\t\t\t$('#watch').html(\"Stop\").removeAttr('disabled').click(stopStream);\n                            },\n                            error: showErrorAndReload,\n                        });\n                    }\n                },\n                onremotestream: function(stream) {\n                    Janus.debug(\" ::: Got a remote stream :::\");\n                    Janus.debug(stream);\n                    console.log('Janus remote stream received');\n                    let vid = me.video.current;\n                    Janus.attachMediaStream(vid, stream);\n                    vid.muted = false;\n                },\n                oncleanup: function() {\n                    Janus.log(\" ::: Got a cleanup notification :::\");\n                }\n            })\n        });\n        this.streaming = streaming;\n        console.log('Janus plugin attached');\n                                    \n        let devices = await navigator.mediaDevices.enumerateDevices();\n        for(let d of devices) {\n            if(d.kind == 'audioinput')\n                haveAudio = true;\n        }\n\n        let result = await new Promise(resolve => streaming.send({\n            message: { request: \"list\" }, \n            success: resolve\n        }));\n\n        if(!result.list || result.list[0].id != STREAM_ID) {\n            throw \"Wrong stream received\";\n        }\n    // \t\t\t\t\t\t\t$('#myVideo')[0].onplaying =  () => toggleLoading(false);\n        streaming.send({\n            message: { request: 'watch', id: STREAM_ID }\n        });\n\n    }\n\n    resize = (e) => {\n        let w = document.documentElement.clientWidth*this.quality,\n            h = document.documentElement.clientHeight*this.quality,\n            W, H;\n        console.log(`${w}x${h}`);\n\n        // fit height, crop width\n        H = Math.round(h/DH/2)*DH*2; W = H*DW/DH;\n        let dh = Math.abs(h-H), dw = Math.abs(w-W);\n        console.log(`fit height: ${W}x${H} ${dw}x${dh} ${W/H}`)    \n        let dw1 = dw, dh1 = dh, W1 = W, H1 = H;\n\n        // fit width, crop height\n        W = Math.round(w/DW/2)*DW*2; H = W*DH/DW;    \n        dh = Math.abs(h-H); dw = Math.abs(w-W);\n        console.log(`fit width: ${W}x${H} ${dw}x${dh} ${W/H}`)\n        let dw2 = dw, dh2 = dh, W2 = W, H2 = H;\n\n        let fit;\n        switch(this.fitMode) {\n            case 'fit_width':\n                fit = {fit_width: true, fit_height: false};\n                W=W2; H=H2;\n            break;\n            case 'fit_height':\n                fit = {fit_width: false, fit_height: true};\n                W=W1; H=H1;\n            break;\n            case 'fit_both':\n                fit = {fit_width: true, fit_height: true};\n                if(w/h > DW/DH) {\n                    // fit height\n                    W = W1; H = H1;\n                } else {\n                    // fit width\n                    W = W2; H = H2;\n                }\n            break;\n            case 'fill':\n                if(w/h < DW/DH) {\n                    fit = {fit_width: false, fit_height: true};\n                    W=W1; H=H1;\n                } else {\n                    fit = {fit_width: true, fit_height: false};\n                    W=W2; H=H2;\n                }\n            break;\n        }\n\n        console.log(`best fit: ${W}x${H}`, fit);\n        if(W >= MAXW || H >= MAXH) {\n            W = MAXW; H = MAXH;\n        } else if(W <= MINW || H <= MINH) {\n            W = MINW; H = MINH;\n        }\n        let newW = W, newH = H;\n        \n        this.setState(fit, () => {\n            this.zoom(0.0);\n            if(this.resizeTm) {\n                clearTimeout(this.resizeTm);\n            }\n            this.resizeTm = setTimeout(() => {\n                this.props.onResize(newW, newH);\n                this.resizeTm = null;\n            }, RESIZE_TIMEOUT);\n        });\n    }\n\n    set(name, value) {\n        if(name == 'fit_mode') {\n            this.fitMode = value;\n        } else if(name == 'quality') {\n            this.quality = QUALITY[value];\n        } else {\n            console.error(`Unknown \"${name}\"`);\n            return;\n        }\n        this.resize();\n    }\n\n    setTransform(dx, dy, scale) {\n        let tr = `translateX(${dx}px) `;\n        if(this.state.fit_width)\n            tr += `translateY( calc( ${dy}px - 50% ) )`;\n        else\n            tr += `translateY(${dy}px)`\n        if(!scale)\n            scale = this.scale;\n        tr += ` scale(${scale})`;\n        this.setState({transform: tr})\n        this.tX = dx; this.tY = dy;\n    }\n\n    zoom(z) {\n        if(z == 0.0)\n            this.scale = 1.0;\n        else\n            this.scale += z;\n        this.setTransform(0, 0);\n    }\n\n    onKeyDown = (e) => {\n        console.log(e.code);\n        if(KEYS[e.code])\n            this.props.onCameraMove(KEYS[e.code])\n    }\n    \n    mute(b) {\n        console.log('mute', b);\n        if(!this.streaming)\n            return;\n\n        if(b) {\n            this.streaming.muteAudio();\n        } else {\n            this.streaming.unmuteAudio();\n        }\n    }\n\n    /**\n     * @returns {string} width, height, bitrate\n     */\n    status() {\n        if(!this.streaming)\n            return '<no video>'\n        let b = parseInt(this.streaming.getBitrate()),\n            v = this.video.current, \n            w = v.videoWidth, \n            h = v.videoHeight;\n        if(Janus.webRTCAdapter.browserDetails.browser == 'safari')\n            b = Math.round(b / 1000);\n        return `${w}x${h} @ ${b} kb/s`;\n    }\n\n    render() {\n        return (\n        <video autoPlay muted playsInline loop \n            id=\"myVideo\"\n            className={`${this.state.fit_width? 'fit_width': ''} ${this.state.fit_height? 'fit_height': ''}`}\n            style={{transform: this.state.transform}}\n            ref={this.video}\n            onMouseDown={this.touchDown}\n            onMouseMove={this.touchMove}\n            onTouchStart={this.touchDown}\n            onTouchMove={this.touchMove}\n            onKeyDown={this.onKeyDown}\n            onPlaying={this.playing} onTimeUpdate={this.time} >\n            \n            {/* <source src=\"https://www.w3schools.com/howto/rain.mp4\" type=\"video/mp4\"></source> */}\n            Your browser does not support HTML5 video.\n        </video>)\n    }\n}\n","import './Dialog.css'\nimport React, { Component } from 'react';\nimport {Modal, Button} from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons';\n\n\nexport class RetryReload extends Component {\n    state = {\n        show: false, \n        message: {\n            header: '',\n            text: ''\n        }\n    };\n\n    async show(message) {\n        return new Promise((resolve) => {\n            this.setState({show: true, message: message}, () => {\n                this.onClose = resolve;\n            });\n        })\n    }\n\n    handleClose = (e) => {\n        let name = e && e.target.name;\n        this.setState({ show: false }, () => {\n            if(name && this.onClose)\n                this.onClose(name);\n        });\n    }\n\n    render() {\n        return (\n            <Modal show={this.state.show} onHide={this.handleClose}  dialogClassName=\"dialog-div\">\n                <Modal.Header closeButton>\n                    <FontAwesomeIcon icon={this.props.icon || faExclamationTriangle} className=\"dialog-icon\" />\n                    <Modal.Title>{this.state.message.header}</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>{this.state.message.text}</Modal.Body>\n                <Modal.Footer>\n                    <Button variant=\"secondary\" onClick={this.handleClose} name=\"retry\">\n                        Retry\n                    </Button>\n                    <Button variant=\"primary\" onClick={this.handleClose} name=\"reload\">\n                        Reload\n                    </Button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","import './Status.css'\nimport React, { Component } from 'react';\n\nexport default class Status extends Component {\n    render() {\n        return (\n            <div id=\"statusDiv\">            \n                <span id=\"videoInfoSpan\">{this.props.info}</span>\n                <br />\n                <span id=\"videoExtraSpan\">{this.props.extra}</span>\n            </div>\n        );\n    }\n}\n","import './Spinner.css'\nimport React, { Component } from 'react';\n\n\nexport default class Spinner extends Component {\n\n    render() {\n        return (\n            <div className={`animationload ${this.props.hidden? 'animationload-after': ''}`} id=\"loadingAnim\">\n                <div className=\"osahanloading\"></div>\n                <h3 className=\"loadingMessage\">Loading</h3>\n            </div>\n        );\n    }\n}\n","import 'bootstrap/dist/css/bootstrap.css';\nimport './App.css';\n\nimport React, { Component } from 'react';\nimport MicButton from './MicButton';\nimport FullscreenButton from './FullscreenButton';\nimport {PlusButton, MinusButton} from './ZoomButton';\nimport SettingsButton from './SettingsButton';\nimport {CameraJoystick, EngineJoystick} from './Joystick';\nimport Video from './Video';\nimport { RetryReload } from './Dialog';\nimport Status from './Status';\nimport Spinner from './Spinner';\n\n\nconst RECONNECT_TIMEOUT = 1000,\n        CAMERA_MOVE_STEP = 0.5;\n\nexport default class App extends Component {\n    state = {\n        joystickConnected: false, \n        plusDisabled: true, \n        minusDisabled: true,\n        statusText: \"\",\n        loading: true\n    };\n    config = null;\n    reconnectTimeout = 0;\n\n    /** @type {WebSocket} */ ws = null;\n    /** @type {React.RefObject<Video>} */ video = React.createRef();\n    /** @type {React.RefObject<RetryReload>} */ modal = React.createRef();\n    /** @type {React.RefObject<PlusButton>} */ plus = React.createRef();\n    /** @type {React.RefObject<MinusButton>} */ minus = React.createRef();\n    /** @type {React.RefObject<Status>} */ status = React.createRef();\n    /** @type {React.RefObject<Spinner>} */ spinner = React.createRef();\n    \n    connectJoystick() {\n        if(!this.state.config.joystick) {\n            this.setState({joystickConnected: true});\n            return;\n        }\n        /** @type {WebSocket} */ let ws = null;\n        try {\n            console.log('connecting joystick...');\n            this.reconnectTimeout = 0;\n            if(this.state.config.joystick)\n                ws = new WebSocket(this.state.config.joystick);\n        } catch(e) {\n            console.log('connecting joystick: error', e);\n            if(!this.reconnectTimeout)\n                this.reconnectTimeout = setTimeout(() => this.connectJoystick(), RECONNECT_TIMEOUT);\n            else\n                console.log('timeout already started')\n            return;\n        }\n        if(!ws)\n            return;\n\n        ws.onopen = () => {\n            console.log('joystick connected!');\n            this.ws = ws;\n            this.ws.send(JSON.stringify({cmd: 'hello'}));\n            this.setState({joystickConnected: true});\n        }\n        ws.onmessage = (msg) => {\n            console.log(msg);\n        }\n        ws.onerror = (err) => {\n            // console.log(err);\n        }\n        ws.onclose = () => {\n            this.ws = null;\n            this.setState({joystickConnected: false});\n            console.log('joystick disconnected');\n            if(!this.reconnectTimeout) {\n                this.reconnectTimeout = setTimeout(() => this.connectJoystick(), RECONNECT_TIMEOUT);\n            } else\n                console.log('timeout already started')\n        }\n    }\n\n    constructor() {\n        super();\n        this.fetchConfig().then(() => this.connectJoystick());\n    }\n\n    sendCommand(cmd) {\n        if(this.ws) {\n            this.ws.send(JSON.stringify(cmd));\n        }\n    }\n\n    onJoystickMove = (a, force) => {\n        console.log(a, force);\n        this.sendCommand({\n            cmd: 'move',\n            degree: a,\n            force: force\n        });\n    }\n\n    onJoystickEnd = (t) => {\n        console.log('engine joystick: end');\n        this.sendCommand({\n            cmd: 'end'\n        });\n    }\n\n    onSettingsChanged = (name, value) => {\n        console.log(`${name} = ${value}`, this.video);\n        this.video.current.set(name, value);\n        // TODO: update Video element\n    }\n\n    onVideoError = async (e) => {\n        console.error(e);\n        let res = await this.modal.current.show(\n            {header: 'Warning!', text: 'Cannot connect to server'});\n        console.log(res);\n        if(res == 'reload')\n            window.location.reload();\n        else\n            this.setState({loading: true});\n    }\n\n    onVideoStarted = () => {\n        console.log('VIDEO STARTED');\n        this.setState({loading: false});\n        this.updateScaleButtons();\n        if(this.statusInterval)\n            return;\n        this.statusInterval = setInterval(() => {\n            this.setState({statusText: this.video.current.status()});\n        }, 1000);\n    }\n\n    onVideoTime = (t) => {\n        this.setState({statusExtra: t.toFixed(1)});\n    }\n\n    onVideoSize = (newW, newH) => {\n        this.sendCommand({\n            cmd: 'resolution', \n            width: newW, \n            height: newH\n        });\n        this.updateScaleButtons();\n    }\n\n    updateScaleButtons() {\n        this.setState({\n            minusDisabled: this.video.current.scale <= 1.0,\n            plusDisabled: false\n        });\n    }\n\n    onZoomIn = () => {\n        this.video.current.zoom(0.1);\n        this.updateScaleButtons();\n    }\n\n    onZoomOut = () => {\n        this.video.current.zoom(-0.1);\n        this.updateScaleButtons();\n    }\n\n    onCameraMove = (d) => {\n        console.log(d);\n        let plains = {\n            left: ['h', CAMERA_MOVE_STEP],\n            right: ['h', -CAMERA_MOVE_STEP],\n            down: ['v', CAMERA_MOVE_STEP],\n            up: ['v', -CAMERA_MOVE_STEP]\n        }\n        let [plain, step] = plains[d];\n        this.sendCommand({\n            cmd: 'look',\n            plain,\n            step\n        });\n    }\n\n    onCameraJoystickEnd = () => {\n        console.log('camera joystick: end');\n    }\n\n    onCameraJoystickMove = (plain, step) => {\n        console.log(plain, step);\n        this.sendCommand({\n            cmd: 'look',\n            plain,\n            step\n        });\n    }\n    \n    onMute = (b) => {\n        this.video.current.mute(b);\n    }\n\n    async fetchConfig () {\n        let response = await fetch(\"web-config.json\");\n        let data = await response.json();\n        let cfg = data;\n        console.log(cfg);\n        let config = cfg;\n        config.janus = cfg.janus && cfg.janus.replace(/{HOST}/g, document.location.host)\n        config.joystick = cfg.joystick && cfg.joystick.replace(/{HOST}/g, document.location.host)\n        this.setState({config});\n    }    \n\n    render() {\n        return (<>\n            <Spinner ref={this.spinner} hidden={!this.state.loading}/>\n            { this.state.config && <Video \n                                    ref={this.video} \n                                    config={this.state.config} \n                                    onStarted={this.onVideoStarted}\n                                    onError={this.onVideoError}\n                                    onResize={this.onVideoSize}\n                                    onCameraMove={this.onCameraMove}\n                                    onResize={this.onVideoSize}\n                                    onTime={this.onVideoTime}/> }\n            <MicButton onMute={this.onMute} />\n            <FullscreenButton />\n            { this.state.joystickConnected && <EngineJoystick \n                                                onEnd={this.onJoystickEnd} \n                                                onMove={this.onJoystickMove} /> }\n            { this.state.joystickConnected && <CameraJoystick \n                                                onEnd={this.onCameraJoystickEnd} \n                                                onMove={this.onCameraJoystickMove}/> }\n            <SettingsButton onChange={this.onSettingsChanged} />\n            <PlusButton  onClick={this.onZoomIn} ref={this.plus} disabled={this.state.plusDisabled}/>\n            <MinusButton onClick={this.onZoomOut} ref={this.minus} disabled={this.state.minusDisabled}/>\n            <RetryReload ref={this.modal}/>\n            <Status ref={this.status} info={this.state.statusText} extra={this.state.statusExtra}/>\n        </>)\n    }\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport App from './App';\n\n\nReactDOM.render(<App />, document.getElementById('root'));\ndocument.body.addEventListener('touchmove', (e) => e.preventDefault(), { passive: false });\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}